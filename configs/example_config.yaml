name: example_experiment
description: >
  Sample experiment generating adversarial samples with AutoAttack, applying the R-SMoE and JPEG Compression defenses,
  and evaluating a ResNet-50 classifier.
seed: 123
work_dir: runs
dataset:
  type: imagenet-autoattack
  name: imagenet_subset
  params:
    count: 10
    min_confidence: 0.0
    require_correct: false
    batch_size: 16
    seed: 123
  attacks:
    - type: autoattack
      name: autoattack_linf
      params:
        attacks: ["apgd-ce", "apgd-t", "square"]
        eps: 0.05 # 0.0313725 8/255
        norm: Linf
        batch_size: 8
        device: auto
model:
  type: timm
  params:
    architecture: resnet50
    pretrained: true
inference:
  type: timm
  params:
    batch_size: 64
    device: auto
    topk: 5
defenses:
  - type: r-smoe
    name: r_smoe_standard
    params:
      root: external/r-smoe
      mode: standard
      iterations: 500
      kernels: 2000
      file_name_prefix: rsmoe
  - type: jpeg
    name: jpeg_compression_quality_75
    params:
      quality: 75
  - type: grayscale
    name: grayscale_default
    params:
      replicate_rgb: true
  - type: crop-resize
    name: crop_resize_224
    params:
      crop_size: [256, 256]
      resize_size: [224, 224]
      interpolation: lanczos
  - type: bit-depth
    name: bit_depth_4bit
    params:
      bits: 4
      dither: true
  - type: tvm
    name: tvm_default
    params:
      weight: 0.08
      eps: 1.0e-4
      n_iter_max: 200
  - type: low-pass
    name: low_pass_gaussian
    params:
      filter: gaussian
      sigma: 1.2
  - type: flip
    name: flip_horizontal
    params:
      direction: horizontal
evaluation:
  type: imagenet
  params:
    topk: [1, 5]
