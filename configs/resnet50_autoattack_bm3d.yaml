name: resnet50_autoattack_bm3d
description: >
  Run AutoAttack on a small ImageNet subset, denoise adversarial images with a CUDA BM3D backend,
  and evaluate a pretrained ResNet-50 classifier.
seed: 123
work_dir: runs
dataset:
  type: imagenet-autoattack
  name: imagenet_subset
  params:
    count: 50
    min_confidence: 0.0
    require_correct: false
    batch_size: 16
    seed: 123
  attacks:
    - type: autoattack
      name: autoattack_linf
      params:
        attacks: ["apgd-ce", "apgd-t", "square"]
        eps: 0.0313725
        norm: Linf
        batch_size: 8
        device: auto
model:
  type: timm
  params:
    architecture: resnet50
    pretrained: true
inference:
  type: timm
  params:
    batch_size: 64
    device: auto
    topk: 5
defenses:
  - type: bm3d
    name: bm3d_cli_gpu
    params:
      backend: cli
      cli_binary: external/bm3d-gpu/build/bm3d
      cli_color_mode: auto
      cli_twostep: true
      cli_quiet: true
      sigma: 30.0
      sigma_scale: pixel
      convert_mode: rgb
      preserve_alpha: true
      workers: 2
evaluation:
  type: imagenet
  params:
    topk: [1, 5]
